sequenceDiagram
    participant User
    participant PC as ProveedorMovimientoController
    participant PS as ProveedorMovimientoService
    participant PR as ProveedorMovimientoRepository
    participant DB as Database

    User->>+PC: GET /proveedorMovimiento/arca/regimen/informacion/compras/{desde}/{hasta}
    PC->>+PS: findAllByRegimenInformacionCompras(desde, hasta)
    PS->>+PR: findAllByFechaContableBetweenAndComprobanteLibroIva(desde, hasta, 1, sort)
    PR->>+DB: SELECT * FROM proveedor_movimiento WHERE fecha_contable BETWEEN ? AND ? AND comprobante_libro_iva = 1 ORDER BY fecha_comprobante, prefijo, numero_comprobante
    DB-->>-PR: Lista de movimientos filtrados
    PR-->>-PS: Lista filtrada por IVA
    PS-->>-PC: Lista final
    PC-->>-User: 200 OK (body: Lista de ProveedorMovimiento)

    User->>+PC: GET /proveedorMovimiento/resumen/iva/compras/posicion/{anho}/{mes}
    PC->>+PS: getAllResumenIvaComprasMensualPosicion(anho, mes)
    PS->>+PR: findAllResumenPosicionByYearAndMonth(anho, mes)
    PR->>+DB: SELECT negocio_id, anho, mes, posicion, SUM(neto) AS neto, ... FROM movprov JOIN proveedores ... GROUP BY negocio_id, anho, mes, posicion
    DB-->>-PR: Lista de resúmenes por posición
    PR-->>-PS: Lista mapeada
    PS-->>-PC: Lista final con nombres de posición
    PC-->>-User: 200 OK (body: Lista de ResumenIvaComprasMensualPosicionResponse)