graph TB
    subgraph "Hexagonal Architecture - ETEREA Core Service"
        
        subgraph "Facturación Nacional"
            FN_API[Facturación Controller<br/>hexagonal.facturacion.arca.nacional.infrastructure.web.controller]
            FN_APP[Facturación Service<br/>hexagonal.facturacion.arca.nacional.application.service]
            FN_DOMAIN[Facturación DTOs<br/>hexagonal.facturacion.arca.nacional.infrastructure.web.dto]
        end
        
        subgraph "Facturación Exportación"
            FE_API[Exportación Controller<br/>hexagonal.facturacion.arca.exportacion.infrastructure.web.controller]
            FE_APP[Exportación Service<br/>hexagonal.facturacion.arca.exportacion.application.service]
            FE_DOMAIN[Exportación DTOs<br/>hexagonal.facturacion.arca.exportacion.infrastructure.web.dto]
        end
        
        subgraph "Gestión Empresa"
            E_API[Empresa Controller<br/>hexagonal.empresa.infrastructure.web.controller]
            E_APP[Empresa Service<br/>hexagonal.empresa.application.service]
            E_DOMAIN[Empresa Model<br/>hexagonal.empresa.domain.model]
            E_PORTS[Ports In/Out<br/>hexagonal.empresa.domain.ports]
        end

        subgraph "Gestión Legajo"
            L_API[Legajo Controller<br/>hexagonal.legajo.infrastructure.web.controller]
            L_APP[Legajo Service<br/>hexagonal.legajo.application.service]
            L_DOMAIN[Legajo Model<br/>hexagonal.legajo.domain.model]
            L_PORTS[Ports In/Out<br/>hexagonal.legajo.domain.ports]
        end

        subgraph "Consulta de Datos de Facturación"
            ID_API[InvoiceData Controller<br/>hexagonal.invoicedata.infrastructure.web]
            ID_APP[InvoiceData Service<br/>hexagonal.invoicedata.application.service]
            ID_DOMAIN[InvoiceData Model<br/>hexagonal.invoicedata.domain.model]
            ID_PORTS[Ports In<br/>hexagonal.invoicedata.domain.ports.in]
        end
        
        subgraph "Persistence Layer"
            E_REPO[Empresa Repository Adapter<br/>hexagonal.empresa.infrastructure.persistence.repository]
            E_ENTITY[Empresa Entity<br/>hexagonal.empresa.infrastructure.persistence.entity]
            E_MAPPER[Empresa Mapper<br/>hexagonal.empresa.infrastructure.persistence.mapper]
            L_REPO[Legajo Repository Adapter<br/>hexagonal.legajo.infrastructure.persistence.repository]
            L_ENTITY[Legajo Entity<br/>hexagonal.legajo.infrastructure.persistence.entity]
            L_MAPPER[Legajo Mapper<br/>hexagonal.legajo.infrastructure.persistence.mapper]
        end
        
        subgraph "External Clients"
            AFIP[AFIP Client<br/>client.arca.FacturacionAfipClient]
            CONSUL[Consul Discovery]
            DB[(MySQL Database)]
        end
        
        %% API Layer to Application Layer
        FN_API --> FN_APP
        FE_API --> FE_APP
        E_API --> E_APP
        L_API --> L_APP
        ID_API --> ID_APP
        
        %% Application to Domain
        FN_APP --> FN_DOMAIN
        FE_APP --> FE_DOMAIN
        E_APP --> E_DOMAIN
        E_APP --> E_PORTS
        L_APP --> L_DOMAIN
        L_APP --> L_PORTS
        ID_APP --> ID_DOMAIN
        ID_APP --> ID_PORTS
        
        %% Domain to Infrastructure
        E_PORTS --> E_REPO
        E_REPO --> E_ENTITY
        E_REPO --> E_MAPPER
        E_ENTITY --> DB
        L_PORTS --> L_REPO
        L_REPO --> L_ENTITY
        L_REPO --> L_MAPPER
        L_ENTITY --> DB
        ID_PORTS --> DB
        
        %% External Dependencies
        FN_APP --> AFIP
        FE_APP --> AFIP
        E_API --> CONSUL
        ID_APP --> E_API
        
        style FN_API fill:#e1f5fe
        style FE_API fill:#e1f5fe
        style E_API fill:#e1f5fe
        style L_API fill:#e1f5fe
        style ID_API fill:#e1f5fe
        style FN_APP fill:#f3e5f5
        style FE_APP fill:#f3e5f5
        style E_APP fill:#f3e5f5
        style L_APP fill:#f3e5f5
        style ID_APP fill:#f3e5f5
        style DB fill:#ffebee
    end